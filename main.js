(()=>{"use strict";var e;function t(e){e.classList.add("popup_opened"),document.addEventListener("keydown",o)}function n(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",o)}function o(e){"Escape"===e.key&&n(document.querySelector(".popup_opened"))}fetch("https://nomoreparties.co/v1/wbf-cohort-15/users/me",{headers:{authorization:"f242fa5c-fb40-413f-b404-5d6d6d13f451"}}).then((function(e){return e.json()})).then((function(e){})),fetch("https://nomoreparties.co/v1/wbf-cohort-15/cards",{headers:{authorization:"f242fa5c-fb40-413f-b404-5d6d6d13f451"}}).then((function(e){return e.json()})).then((function(e){})),fetch("https://nomoreparties.co/v1/wbf-cohort-15/users/me",{method:"PATCH",headers:{authorization:"f242fa5c-fb40-413f-b404-5d6d6d13f451","Content-Type":"application/json"},body:JSON.stringify({name:"im",about:"gay"})}).then((function(e){return e.json()})).then((function(e){})),fetch("https://nomoreparties.co/v1/wbf-cohort-15/cards",{method:"POST",headers:{authorization:"f242fa5c-fb40-413f-b404-5d6d6d13f451","Content-Type":"application/json"},body:JSON.stringify({name:"Loli",link:"https://img2.reactor.cc/pics/post/Anime-девушка-красивые-картинки-Anime-Original-1135748.jpeg"})}).then((function(e){return e.json()})).then((function(e){})),document.querySelectorAll(".popup").forEach((function(e){return e.addEventListener("click",(function(t){t.target.classList.contains("popup")&&n(e)}))}));var r=["inputSelector","submitButtonSelector","inactiveButtonClass"];function c(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},c=Object.keys(e);for(o=0;o<c.length;o++)n=c[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(o=0;o<c.length;o++)n=c[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var i=document.querySelector("#new_element").content;function a(t,n){var o=i.querySelector(".element").cloneNode(!0);o.querySelector(".element__text").textContent=t.name;var r=o.querySelector(".element__image");r.src=t.link,r.alt=t.name;var c=o.querySelector(".element__like-pic"),a=o.querySelector(".element__like-number");a.textContent=t.likes.length,t.likes.like._id===e&&c.classList.add("element__like_active"),c.addEventListener("click",(function(e){var n;e.targetclassList.contains("element__like_active")?(n=t._id,void fetch("https://nomoreparties.co/v1/wbf-cohort-15/cards/likes/".concat(n),{method:"DELETE",headers:{authorization:"f242fa5c-fb40-413f-b404-5d6d6d13f451","Content-Type":"application/json"}}).then((function(e){if(e.ok)return e.json()})).catch((function(e){console.log("Problem",e)}))).then((function(e){c.classList.toggle("element__like_active"),a.textContent=e.likes.length})).catch((function(e){console.log("Error:"+e)})):function(e){fetch("https://nomoreparties.co/v1/wbf-cohort-15/cards/likes/".concat(e),{method:"PUT",headers:{authorization:"f242fa5c-fb40-413f-b404-5d6d6d13f451","Content-Type":"application/json"}}).then((function(e){if(e.ok)return e.json()})).catch((function(e){console.log("Problem",e)}))}(t._id).then((function(e){c.classList.toggle("element__like_active"),a.textContent=e.likes.length})).catch((function(e){console.log("Error:"+e)}))})),r.addEventListener("click",(function(){return n(t.link,t.name)}));var l=o.querySelector(".element__delete-icon");return e===t.owner._id?l.addEventListener("click",(function(){var e;(e=t._id,void fetch("https://nomoreparties.co/v1/wbf-cohort-15/cards/".concat(e),{method:"DELETE",headers:{authorization:"f242fa5c-fb40-413f-b404-5d6d6d13f451","Content-Type":"application/json"}}).then((function(e){if(e.ok)return e.json()})).catch((function(e){console.log("Problem",e)}))).then((function(){o.remove()})).catch((function(e){console.log("Error:"+e)}))})):l.remove(),o}var l,u,s,d=document.querySelector(".elements"),f=document.getElementById("picture"),p=document.getElementById("place-close"),m=document.querySelector(".profile__info-picture"),h=document.querySelector(".popup__close"),v=document.querySelector(".profile__add-button"),_=document.querySelector(".popup__close_pic"),y=document.getElementById("nickname"),E=document.getElementById("name"),b=document.getElementById("proffesion"),g=document.querySelector(".profile__main-text"),k=document.querySelector(".profile__text"),L=document.getElementById("place"),S=document.getElementById("name-place"),C=document.getElementById("link-picture"),q=document.getElementById("form-Place"),B=document.getElementById("saveButton"),x=document.getElementById("place-save"),j=document.getElementById("avatar"),I=document.getElementById("avatarPic"),w=document.getElementById("link-profile"),P=document.getElementById("profile"),T=document.getElementById("formProfile"),A=document.getElementById("profileClose"),O=document.getElementById("profile-save");function z(e,n){t(f),f.querySelector(".popup__image").src=e,f.querySelector(".popup__image").alt=n,f.querySelector(".popup__caption").textContent=n}m.addEventListener("click",(function(){t(y),E.value=g.textContent,b.value=k.textContent,B.textContent="Сохранить"})),h.addEventListener("click",(function(){n(y)})),v.addEventListener("click",(function(){q.reset(),x.classList.add("popup__button_disabled"),x.setAttribute("disabled",""),t(L),function(e,t,n){Array.from(e.querySelectorAll(".popup__error")).forEach((function(e){e.textContent=""})),t.classList.remove("popup__input_noname"),n.classList.remove("popup__input_noname")}(L,S,C),x.textContent="Сохранить"})),p.addEventListener("click",(function(){n(L)})),_.addEventListener("click",(function(){n(f)})),j.addEventListener("click",(function(){t(P),T.reset(),P.querySelector(".popup__error").textContent="",w.classList.remove("popup__input_noname"),O.textContent="Сохранить"})),A.addEventListener("click",(function(){n(P)})),x.addEventListener("click",(function(){return x.textContent="Сохранение...",n(L),void d.prepend(a(S.value,C.value))})),B.addEventListener("click",(function(){return B.textContent="Сохранение...",g.textContent=E.value,k.textContent=b.value,void n(y)})),O.addEventListener("click",(function(){return O.textContent="Сохранение...",I.src=w.value,void n(P)})),Promise.all([void fetch("https://nomoreparties.co/v1/wbf-cohort-15/cards",{method:"GET",headers:{authorization:"f242fa5c-fb40-413f-b404-5d6d6d13f451","Content-Type":"application/json"}}).then((function(e){if(e.ok)return e.json()})).catch((function(e){console.log("Problem",e)})),void fetch("https://nomoreparties.co/v1/wbf-cohort-15/users/me",{method:"GET",headers:{authorization:"f242fa5c-fb40-413f-b404-5d6d6d13f451","Content-Type":"application/json"}}).then((function(e){if(e.ok)return e.json();console.log(e.name)})).catch((function(e){console.log("Problem",e)}))]).then((function(t){var n;console.log(t[1].name),n=t[1]._id,e=n,t[0].forEach((function(e){var t;t=a(e,z),d.prepend(t)}))})).catch((function(e){console.log("Error in promise:"+e)})),u=(l={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:".popup__error_",errorClass:"popup__error_visible",inputErrorLine:"popup__input_noname"}).formSelector,s=c(l,["formSelector"]),Array.from(document.querySelectorAll(u)).forEach((function(e){!function(e,t){var n=t.inputSelector,o=t.submitButtonSelector,i=t.inactiveButtonClass,a=c(t,r),l=e.querySelector(o);e.addEventListener("input",(function(){Array.from(e.querySelectorAll(n)).forEach((function(t){!function(e,t,n){t.validity.valid?function(e,t,n){var o=n.errorClass,r=n.inputErrorClass,c=n.inputErrorLine,i=e.querySelector(r+t.id);t.classList.remove(c),i.classList.remove(o),i.textContent=""}(e,t,n):function(e,t,n){var o=n.errorClass,r=n.inputErrorClass,c=n.inputErrorLine,i=e.querySelector(r+t.id);t.classList.add(c),i.classList.add(o),i.textContent=t.validationMessage}(e,t,n)}(e,t,a),function(e,t,n){0==e.checkValidity()?function(e,t){e.classList.add(t),e.setAttribute("disabled","")}(t,n):(t.classList.remove(n),t.removeAttribute("disabled"))}(e,l,i)}))}))}(e,s)}))})();